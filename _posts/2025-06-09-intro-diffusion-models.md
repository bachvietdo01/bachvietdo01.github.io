---
layout: post
title: "A Gentle Intro to Diffusion Models"
author: "Bach Do"
categories: journal
tags: [documentation,sample]
image: a2_diffusion_model_logo.gif
---

Diffusion models have recently emerged as a powerful class of deep generative models, achieving state-of-the-art results in image generation, audio synthesis, protein design, and many scientific domains. Notable works in the literature include [Sohl-Dickstein et al. (2015)](https://arxiv.org/abs/1503.03585), [Ho et al. (2020)](https://arxiv.org/abs/2006.11239), [Song, Ermon et al. (2019)](https://arxiv.org/abs/1907.05600), [Song, Sohl-Dickstein et al. (2020)](https://arxiv.org/abs/2011.13456), and [Karras et al. (2022)](https://arxiv.org/abs/2206.00364). This introduction explains the core idea of diffusion models as flows generated by a Stochastic Differential Equation (SDE) and walks through a full example of how to sample an 11-component Gaussian mixture data starting from a standard normal initial distribution. The full codes can be found [here](https://github.com/bachvietdo01/generative_models/tree/main/diffusion_model).


## Stochastic Flows by SDE

A common view of diffusion models is learning to reverse a forward process that progressively diffuse data into noise. However, they can also be seen as a stochastic counterpart to flow matching models (see Holderrieth et al., 2025). Flow matching describes flows generated by an ODE: $\frac{dX_t}{dt} = u_t(X_t)$. On the other hand, diffusion models are stochastic flows, solutions to the Stochastic Differential Equation:

$$
\begin{aligned}
dX_t = u_t(X_t)dt + \frac{\sigma_t^2}{2} \log \nabla \log p_t(X_t) dt + \sigma_t d W_t
\end{aligned}
$$

Here, $X_t \sim p_t(\cdot)$ traces the marginal probability path, $u_t(X_t)$ is the deterministic vector field, $\sigma_t^2$ is the diffusion coefficient, and $W_t$ denotes Brownian motion.

<p align="center">
<img src="https://github.com/bachvietdo01/bachvietdo01.github.io/blob/main/assets/img/a2_ode_traj.png?raw=true" alt="ode_traj" width="450"/>
<img src="https://github.com/bachvietdo01/bachvietdo01.github.io/blob/main/assets/img/a2_sde_traj.png?raw=true" alt="sde_traj" width="450"/> 
</p>

## Reference

[1] Lipman, Y., Chen, R. T., Ben-Hamu, H., Nickel, M., & Le, M. (2022). Flow matching for generative modeling. arXiv preprint arXiv:2210.02747.

[2] Holderrieth, Peter, and Ezra Erives. "An Introduction to Flow Matching and Diffusion Models." arXiv preprint arXiv:2506.02070 (2025).




